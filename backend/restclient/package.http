@baseUrl = http://localhost:3000
@contentType = application/json
@adminToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0MTg1NTU4NC0yYWI0LTRhZjMtOTQzMS0zMGE0NDA0OGU1YjciLCJlbWFpbCI6Im1lbGlzc2FtYWtlYmFAZ21haWwuY29tIiwicm9sZSI6IkFETUlOIiwiaWF0IjoxNzUzNjk0MzE2LCJleHAiOjE3NTM3ODA3MTZ9.VTDB8AArgsnGTGyt24iskU4CRnRgPCgK3QChce690nA
@senderToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJlOWFmMzU5Yi0wOTViLTRlNzItYTdhMC02OTZjMGQ1YmU0NTciLCJlbWFpbCI6Im1lbGxpc2F3YW5qYTI1NEBnbWFpbC5jb20iLCJyb2xlIjoiU0VOREVSIiwiaWF0IjoxNzUzNjkyODA1LCJleHAiOjE3NTM2OTM3MDV9.ZWLYAJot-_SbekODZMaco8Epvkb36_nwoygnRxgp0R4
@courierToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI1YjQwNDY1YS0wY2E1LTRjNzgtOGJkZC1kYTc3MjcxZmNmNDYiLCJlbWFpbCI6Im1lbGsuaWxlbmEuYUBnbWFpbC5jb20iLCJyb2xlIjoiQ09VUklFUiIsImlhdCI6MTc1MzY5MjY1NCwiZXhwIjoxNzUzNjkzNTU0fQ.fpX2mm9q6ui_jfyDWEhdjBkaDd2hQjA1apysoeyo4ms
@packageId = 12345678-abcd-1234-efgh-123456789012
@trackingId = DS4A2B3C1234

### Create Package (Admin only)
POST {{baseUrl}}/packages
Content-Type: {{contentType}}
Authorization: Bearer {{adminToken}}

{
  "senderId": "e9af359b-095b-4e72-a7a0-696c0d5be457",
  "senderEmail": "mellisawanja254@gmail.com",
  "receiverName": "Jane Doe",
  "receiverEmail": "melissa.waitituh@strathmoree.edu",
  "receiverPhone": "+1234567890",
  "receiverAddress": "123 Main St",
  "receiverCity": "Nairobi",
  "receiverState": "Nairobi",
  "receiverZipCode": "00100",
  "receiverCountry": "Kenya",
  "weight": 2.5,
  "description": "Books and Documents",
  "specialInstructions": "Handle with care - fragile items",
  "value": 100,
  "preferredPickupDate": "2025-07-30T10:00:00.000Z",
  "preferredDeliveryDate": "2025-08-02T15:00:00.000Z"
}

### Create Package with Custom Price (Admin only)
POST {{baseUrl}}/packages/create
Content-Type: {{contentType}}
Authorization: Bearer {{adminToken}}

{
  "senderId": "e9af359b-095b-4e72-a7a0-696c0d5be457",
  "senderEmail": "mellisawanja254@gmail.com",
  "receiverName": "John Smith",
  "receiverEmail": "john.smith@example.com",
  "receiverPhone": "+254712345678",
  "receiverAddress": "456 Oak Avenue",
  "receiverCity": "Mombasa",
  "receiverState": "Mombasa",
  "receiverZipCode": "80100",
  "receiverCountry": "Kenya",
  "weight": 5.0,
  "description": "Electronics - Laptop",
  "specialInstructions": "Signature required on delivery",
  "value": 800,
  "price": 750
}

### Get User's Packages (Works for all roles)
GET {{baseUrl}}/packages
Content-Type: {{contentType}}
Authorization: Bearer {{senderToken}}

### Get All Packages (Admin only)
GET {{baseUrl}}/packages/all
Content-Type: {{contentType}}
Authorization: Bearer {{adminToken}}

### Get Package by ID (detailed view)
GET {{baseUrl}}/packages/{{packageId}}
Content-Type: {{contentType}}
Authorization: Bearer {{adminToken}}

### Update Package Status (Admin or Courier)
PUT {{baseUrl}}/packages/{{packageId}}/status
Content-Type: {{contentType}}
Authorization: Bearer {{adminToken}}

{
  "status": "COURIER_ASSIGNED",
  "notes": "Package assigned to courier John Doe"
}

### Update Package Status - In Transit (Courier)
PUT {{baseUrl}}/packages/{{packageId}}/status
Content-Type: {{contentType}}
Authorization: Bearer {{courierToken}}

{
  "status": "IN_TRANSIT",
  "notes": "Package picked up and in transit"
}

### Update Package Status - Delivered
PUT {{baseUrl}}/packages/{{packageId}}/status
Content-Type: {{contentType}}
Authorization: Bearer {{courierToken}}

{
  "status": "DELIVERED",
  "notes": "Package delivered successfully to recipient"
}

### Public Track Package by Tracking ID (No auth required)
GET {{baseUrl}}/packages/track/{{trackingId}}
Content-Type: {{contentType}}

### Assign Courier to Package (Admin only)
PATCH {{baseUrl}}/packages/{{packageId}}/assign-courier
Content-Type: {{contentType}}
Authorization: Bearer {{adminToken}}

{
  "courierId": "5b40465a-0ca5-4c78-8bdd-da77271fcf46"
}

### Update Package Location (Courier only)
POST {{baseUrl}}/packages/{{packageId}}/location
Content-Type: {{contentType}}
Authorization: Bearer {{courierToken}}

{
  "latitude": -1.2921,
  "longitude": 36.8219,
  "address": "Nairobi CBD, Kenya"
}

### Update Package Location with More Details
POST {{baseUrl}}/packages/{{packageId}}/location
Content-Type: {{contentType}}
Authorization: Bearer {{courierToken}}

{
  "latitude": -4.0435,
  "longitude": 39.6682,
  "address": "Mombasa Road, Mombasa, Kenya"
}

### Get Package Location
GET {{baseUrl}}/packages/{{packageId}}/location
Content-Type: {{contentType}}
Authorization: Bearer {{senderToken}}

### Create Delivery Attempt - Successful (Courier only)
POST {{baseUrl}}/packages/{{packageId}}/delivery-attempt
Content-Type: {{contentType}}
Authorization: Bearer {{courierToken}}

{
  "status": "SUCCESSFUL",
  "notes": "Package delivered to recipient Jane Doe at 2:30 PM"
}

### Create Delivery Attempt - Failed (Courier only)
POST {{baseUrl}}/packages/{{packageId}}/delivery-attempt
Content-Type: {{contentType}}
Authorization: Bearer {{courierToken}}

{
  "status": "RECIPIENT_NOT_AVAILABLE",
  "notes": "Recipient not available. Left notice for re-delivery"
}

### Create Delivery Attempt - Address Not Found
POST {{baseUrl}}/packages/{{packageId}}/delivery-attempt
Content-Type: {{contentType}}
Authorization: Bearer {{courierToken}}

{
  "status": "ADDRESS_NOT_FOUND",
  "notes": "Could not locate the delivery address. Need to contact recipient"
}

###############################################
# Test Different Package Scenarios
###############################################

### Heavy Package (will use weight-based pricing)
POST {{baseUrl}}/packages
Content-Type: {{contentType}}
Authorization: Bearer {{adminToken}}

{
  "senderId": "e9af359b-095b-4e72-a7a0-696c0d5be457",
  "senderEmail": "mellisawanja254@gmail.com",
  "receiverName": "Heavy Items Store",
  "receiverEmail": "heavy@example.com",
  "receiverPhone": "+254700000000",
  "receiverAddress": "Industrial Area",
  "receiverCity": "Nairobi",
  "receiverState": "Nairobi",
  "receiverZipCode": "00100",
  "receiverCountry": "Kenya",
  "weight": 15.5,
  "description": "Heavy machinery parts",
  "specialInstructions": "Requires forklift for unloading"
}

### Light Package (minimal pricing)
POST {{baseUrl}}/packages
Content-Type: {{contentType}}
Authorization: Bearer {{adminToken}}

{
  "senderId": "e9af359b-095b-4e72-a7a0-696c0d5be457",
  "senderEmail": "mellisawanja254@gmail.com",
  "receiverName": "Document Recipient",
  "receiverEmail": "docs@example.com",
  "receiverPhone": "+254711111111",
  "receiverAddress": "Office Complex",
  "receiverCity": "Kisumu",
  "receiverState": "Kisumu",
  "receiverZipCode": "40100",
  "receiverCountry": "Kenya",
  "weight": 0.5,
  "description": "Important documents",
  "specialInstructions": "Confidential - hand to recipient only"
}

###############################################
# Error Testing
###############################################

### Try to create package as non-admin (should fail)
POST {{baseUrl}}/packages
Content-Type: {{contentType}}
Authorization: Bearer {{senderToken}}

{
  "senderId": "e9af359b-095b-4e72-a7a0-696c0d5be457",
  "senderEmail": "mellisawanja254@gmail.com",
  "receiverName": "Test User",
  "receiverEmail": "test@example.com",
  "receiverPhone": "+254700000000",
  "receiverAddress": "Test Address",
  "receiverCity": "Nairobi",
  "receiverState": "Nairobi",
  "receiverZipCode": "00100",
  "receiverCountry": "Kenya",
  "weight": 1.0,
  "description": "Test package"
}

### Try to update location as non-courier (should fail)
POST {{baseUrl}}/packages/{{packageId}}/location
Content-Type: {{contentType}}
Authorization: Bearer {{senderToken}}

{
  "latitude": -1.2921,
  "longitude": 36.8219,
  "address": "Unauthorized location update"
}
